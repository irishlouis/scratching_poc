# summarise POC data
poc.summary <- summarise.data(data = poc.raw.data)

# summarise test1 data
test1.summary <- summarise.data(data = test1.raw.data)
cache("test1.summary")

# summarise test2 data
test2.summary <- summarise.data(data = test2.raw.data)
cache("test2.summary")


## add scratching label from subject diary

scratching.times <- c("2017-05-23 10:27:10", "2017-05-23 10:27:20",
                      "2017-05-23 11:22:00", "2017-05-23 11:22:10",
                      "2017-05-23 11:22:20", "2017-05-23 11:55:20",
                      "2017-05-23 11:55:30", "2017-05-23 11:55:40",
                      "2017-05-23 12:02:20", "2017-05-23 12:02:30",
                      "2017-05-23 12:02:40", "2017-05-23 12:02:50",
                      "2017-05-23 12:03:00", "2017-05-23 12:23:30",
                      "2017-05-23 12:23:40", "2017-05-23 12:23:50",
                      "2017-05-23 12:37:30", "2017-05-23 12:37:40",
                      "2017-05-23 12:37:50", "2017-05-23 12:38:00",
                      "2017-05-23 12:38:10", "2017-05-23 12:51:20",
                      "2017-05-23 12:51:30", "2017-05-23 12:51:40",
                      "2017-05-23 14:57:00", "2017-05-23 14:57:10",
                      "2017-05-23 14:57:20", "2017-05-23 16:45:50",
                      "2017-05-23 16:46:00", "2017-05-23 17:44:50",
                      "2017-05-23 17:45:00", "2017-05-23 17:45:10", 
                      "2017-05-23 18:15:50", "2017-05-23 18:16:00", 
                      "2017-05-23 18:16:10", "2017-05-23 19:16:50", 
                      "2017-05-23 19:17:00", "2017-05-23 19:17:10", 
                      "2017-05-23 19:33:20", "2017-05-23 19:33:30",
                      "2017-05-23 19:54:50", "2017-05-23 19:55:00",
                      "2017-05-23 19:55:10", "2017-05-23 20:48:20",
                      "2017-05-23 20:48:30", "2017-05-23 20:48:40",
                      "2017-05-24 07:52:10", "2017-05-24 07:52:20",
                      "2017-05-24 07:52:30", "2017-05-24 08:54:20", 
                      "2017-05-24 08:54:30", "2017-05-24 08:54:40", 
                      "2017-05-24 09:08:40", "2017-05-24 09:08:50", 
                      "2017-05-24 09:09:00", "2017-05-24 09:19:10", 
                      "2017-05-24 09:19:20", "2017-05-24 09:19:30")

subj.diary <- data.table(device_id = "TAS1E31150000",
                         datetime = lapply(scratching.times, ymd_hms))

poc.summary[, scratch_event := "not_scratch"]
for (dev in poc.summary[, unique(device_id)]){
  poc.summary[poc.summary$device_id == dev & poc.summary$epoch_id %in% subj.diary[device_id == dev, datetime], "scratch_event"] <- "scratch"
  # poc.summary[device_id == dev][
  #   epoch_id %in% subj.diary[device_id == dev, datetime], scratch_event := 1]
}

cache("poc.summary")





